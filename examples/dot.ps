%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA DotPlot
%%Creator: PS_dot.c, ViennaRNA Package
%%BoundingBox: 66 211 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox
100 dict begin

/logscale false def

%delete next line to get rid of title
270 665 moveto /Helvetica findfont 14 scalefont setfont (dot.ps) show

/lpmin {
   1e-05 log  % log(pmin) only probs>pmin will be shown
} bind def

/sequence { (\
GGCGCAGUGGGCUAGCGCCACUCAAAAGGCCCAU\
) } def
/len { sequence length } def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul add            % x += 0.5
   exch 2 index 0.5 mul add exch  % x += 0.5
   newpath
   moveto
   dup neg   0 rlineto
   dup neg   0 exch rlineto
             0 rlineto
   closepath
   fill
} def

72 216 translate
72 6 mul len 1 add div dup scale
/Helvetica findfont 0.95 scalefont setfont

% print sequence along all 4 sides
0 1 len 1 sub {
    dup
    0.7 add -0.3 moveto
    sequence exch 1 getinterval
    show
} for

0 1 len 1 sub {
    dup
    0.7 add 0.7 len add moveto
    sequence exch 1 getinterval
    show
} for

90  rotate
0 1 len 1 sub {
    dup
    0.7 add -0.2 moveto
    len 1 sub exch sub
    sequence exch 1 getinterval
    show
} for
270 rotate

270 rotate
0 1 len 1 sub {
    dup
    -0.3 add len sub  0.7 len add  moveto
    sequence exch 1 getinterval
    show
} for
90 rotate

0.5 dup translate
% draw diagonal
0.04 setlinewidth
0 len moveto len 0 lineto stroke 

%draw grid
0.01 setlinewidth
len log 0.9 sub cvi 10 exch exp  % grid spacing
dup 1 gt {
   dup dup 20 div dup 2 array astore exch 40 div setdash
} { [0.3 0.7] 0.1 setdash } ifelse
0 exch len {
   dup dup
   0 moveto
   len lineto 
   dup
   len exch sub 0 exch moveto
   len exch len exch sub lineto
   stroke
} for
0.5 neg dup translate

showpage
end
%%EOF
